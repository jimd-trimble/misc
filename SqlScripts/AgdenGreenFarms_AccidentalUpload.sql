use [UserOp]

-- UserOp DELETE ORDER:
-- SessionAsset
-- AssetDevice
-- Asset
-- SessionHarvest
-- Session
-- Task
-- GrownCrop
-- Field


declare @fieldId bigint = 1301328,
	@agdenFarmId bigint = 311153,
	@highfieldFarmId bigint = 311156,
	@orgId bigint = 51775,
	@adsFldId bigint = 1319172;



-- find other SessionAsset records with fk_AssetID = 47898
-- Check FieldAlias, ClientAlias, FarmAlias tables.

select f.id as FieldID, f.ads_fldId as ADS_fld_id from field f
where f.fk_FarmID in (@agdenFarmId, @highfieldFarmId)
--or f.ID in (1301328, 1301329, 1301330, 1301331, 1301332, 1301334, 1301335, 1301336, 1301337, 1301338, 1301340, 1301341, 1301342, 1301343, 1301344, 1301345, 1301346, 1301347, 1301348, 1301349, 1301350, 1301351, 1301352, 1301353, 1301354, 1301355, 1301356, 1301357, 1301361, 1301362)

select * from FieldAlias
where fk_FieldID in (1301328, 1301329, 1301330, 1301331, 1301332, 1301334, 1301335, 1301336, 1301337, 1301338, 1301340, 1301341, 1301342, 1301343, 1301344, 1301345, 1301346, 1301347, 1301348, 1301349, 1301350, 1301351, 1301352, 1301353, 1301354, 1301355, 1301356, 1301357, 1301361, 1301362)
and fk_OrgID = 51775

select * from FarmAlias
where fk_FarmID in (311153, 311156)
and fk_OrgID = 51775

select * from ClientAlias ca
where fk_ClientID = 1890847
and fk_OrgID = 51775

-- fieldIDs:
-- 1301354, 1301355, 1301356, 1301357, 1301353, 1301352, 1301351, 1301350, 1301349, 1301348, 1301347, 1301346, 1301345, 1301344, 1301343, 1301342, 1301341, 1301340, 1301338, 1301337, 1301336, 1301335, 1301334, 1301332, 1301331, 1301330, 1301329, 1301328, 1301362, 1301361

-- ADS fld_ids (including 2 extra 2018 crop year records):
-- 1319198, 1319199, 1319200, 1319201, 1319197, 1319196, 1319195, 1319194, 1319193, 1319192, 1319191, 1319190, 1319189, 1319188, 1319187, 1319186, 1319185, 1319184, 1319182, 1319181, 1319180, 1319179, 1319178, 1319176, 1319175, 1319174, 1319173, 1319172, 1319206, 1319205, 1319216, 1319217

-- GrownCrops:
--select gc.id as GrownCropID, gc.ads_fldId as ADS_FldId from GrownCrop gc 
--where gc.fk_FieldID in (select f.id from field f where f.fk_FarmID in (@agdenFarmId, @highfieldFarmId))
--or gc.ID in (1798254, 1798255, 1798256, 1798257, 1798258, 1798259, 1798261, 1798262, 1798263, 1798264, 1798265, 1798266, 1798267, 1798268, 1798269, 1798270, 1798271, 1798272, 1798273, 1798274, 1798275, 1798276, 1798277, 1798278, 1798279, 1798280, 1798282, 1798283, 1798260, 1798281)
--order by ads_fldId

-- Crop Seasons: IGNORE
--select mc.*, cs.* from CropSeason cs
--join MasterCrop mc on cs.fk_MasterCropID = mc.ID
--where cs.id in (
--	select gc.fk_CropSeasonId from GrownCrop gc where gc.id in (1798278, 1798279, 1798280, 1798281, 1798282, 1798283, 1798277, 1798276, 1798275, 1798274, 1798273, 1798272, 1798271, 1798270, 1798269, 1798268, 1798267, 1798266, 1798265, 1798264, 1798263, 1798262, 1798261, 1798260, 1798259, 1798258, 1798257, 1798256, 1798255, 1798254)
--)

-- TASKS:
--select id as TaskID from Task t
--where t.fk_GrownCropID in (1798278, 1798279, 1798280, 1798281, 1798282, 1798283, 1798277, 1798276, 1798275, 1798274, 1798273, 1798272, 1798271, 1798270, 1798269, 1798268, 1798267, 1798266, 1798265, 1798264, 1798263, 1798262, 1798261, 1798260, 1798259, 1798258, 1798257, 1798256, 1798255, 1798254)
select * from Task
where id in ('F1278693-E8F0-4DCD-8E6F-46079A5174A1', '74059CA4-FBF5-418A-A724-54D9120F808B', 'F4CC7E29-8998-4602-B13D-AAB98641B4EE', '0AF36AF8-E0F1-4FEA-B150-54F53D8EE154', 'B64BFCFA-491E-49EA-BA4F-5D429CB9EA73', 'F918F06A-F358-4C83-8533-14F2F6AE7BC7', '0E61841B-49EE-4CE2-BACB-4CBA7B36C438', '69327DF7-20CE-45D8-AF3B-1C535859C096', '131BD1B8-421A-43AA-9E80-9A57DBAD92B5', 'E3933D28-5FC7-47EC-895D-D6C6E8F7F139', '57C8F029-7C75-4A2A-955A-FB60111368F5', 'A4F7101F-9AF9-4A5D-8A49-2467E8FC2CC3', '235A4A6C-183E-4786-A52D-93BA4076D007', '521CF076-2ACA-430B-AAB1-28859D41B733', '0E9042D9-D84F-4317-8AB3-F18192D40FC9', '002704D6-6EEA-4183-9D4A-F3CCAB226780', '1EA158FE-5CC3-4CDB-9584-A15300CA846B', '9692D403-D64D-4AC2-B6B4-414470801CF4', '88AED82F-E380-455A-98BA-44A9255392BF', '5C02EC49-0B0E-4B10-9B6C-624984C5359F', '5E171546-4FFE-4B24-BDF6-3F61E92E9CED', '73596190-A8AC-497F-A0E6-8D420D57854B', '8C27B1BE-286B-4203-A550-3BDD7D3B609E', '8E7CD2E7-FA92-447A-82C8-3319B0C6FF97', 'A6F7704D-F3BE-4304-8BF9-E79B4FFBC621', '62445973-12EE-49F1-ADAD-1ED041BFBD7E', 'EF1A0E25-9367-42C2-BEF1-5E5500B496C2', 'A4D2D208-47FF-4EBA-9F11-C98855C93B73', '94C7C338-A6C5-4FF2-8A44-0897942F1BF4', '16FEC9F8-FF3F-4372-A223-91A4EB843041')
-- Sessions:
--select id as SessionID from [Session] where fk_TaskID in ('F1278693-E8F0-4DCD-8E6F-46079A5174A1', '74059CA4-FBF5-418A-A724-54D9120F808B', 'F4CC7E29-8998-4602-B13D-AAB98641B4EE', '0AF36AF8-E0F1-4FEA-B150-54F53D8EE154', 'B64BFCFA-491E-49EA-BA4F-5D429CB9EA73', 'F918F06A-F358-4C83-8533-14F2F6AE7BC7', '0E61841B-49EE-4CE2-BACB-4CBA7B36C438', '69327DF7-20CE-45D8-AF3B-1C535859C096', '131BD1B8-421A-43AA-9E80-9A57DBAD92B5', 'E3933D28-5FC7-47EC-895D-D6C6E8F7F139', '57C8F029-7C75-4A2A-955A-FB60111368F5', 'A4F7101F-9AF9-4A5D-8A49-2467E8FC2CC3', '235A4A6C-183E-4786-A52D-93BA4076D007', '521CF076-2ACA-430B-AAB1-28859D41B733', '0E9042D9-D84F-4317-8AB3-F18192D40FC9', '002704D6-6EEA-4183-9D4A-F3CCAB226780', '1EA158FE-5CC3-4CDB-9584-A15300CA846B', '9692D403-D64D-4AC2-B6B4-414470801CF4', '88AED82F-E380-455A-98BA-44A9255392BF', '5C02EC49-0B0E-4B10-9B6C-624984C5359F', '5E171546-4FFE-4B24-BDF6-3F61E92E9CED', '73596190-A8AC-497F-A0E6-8D420D57854B', '8C27B1BE-286B-4203-A550-3BDD7D3B609E', '8E7CD2E7-FA92-447A-82C8-3319B0C6FF97', 'A6F7704D-F3BE-4304-8BF9-E79B4FFBC621', '62445973-12EE-49F1-ADAD-1ED041BFBD7E', 'EF1A0E25-9367-42C2-BEF1-5E5500B496C2', 'A4D2D208-47FF-4EBA-9F11-C98855C93B73', '94C7C338-A6C5-4FF2-8A44-0897942F1BF4', '16FEC9F8-FF3F-4372-A223-91A4EB843041')
select * from [Session] where id in ('FBE09C32-4949-43A3-8DBA-197E42A69B5E', '59B6AC4C-E0B1-4EC8-8797-53BECAE67701', 'DD2A18D1-2A4E-4463-A7ED-8C75EFB9AA50', '8CC5091C-74CF-47BF-A8F3-1906FEE01D03', 'FD81BCA6-58BF-4A65-8F0F-510D8609AC62', '832E14FD-9839-40B8-B968-9014C5865B6A', 'CE0F4005-ED3B-4346-ACDC-DEF797B4C4DC', '8E76D616-B571-488B-8732-9D2ACEC6633F', '3B29C209-EABA-4E58-BA8A-011FD11DF9E2', '8AE9B2DC-BBBF-4F7B-93EB-8A91A1597D5C', '4227A174-43BE-41DA-BA41-A44F98BDAA62', '06FE811C-1BD8-44EF-80F0-AE6AEADB5EC0', 'EF96D5E1-FB03-4B9B-8A61-E3B7661695B8', '619E35F7-A41C-44E2-B219-BF7B5B4D7AB0', '392A6F6A-32A4-4110-8E0A-436E81152EA8', '8A0B8F6E-D86C-4237-B3F9-8D714349311E', 'F7A17EB3-62EF-4B6D-B35C-2552CB2FD0BE', '469581EE-D1ED-4CAB-B608-837AA08768A2', 'E4FB6894-5398-4B03-9E16-14ED2DE8CB3E', 'C2E2EAAD-6B87-4C34-BC0A-64AFFA641DB6', '8EACB92E-8E8C-42FD-A90A-DF31437BE334', 'EBB1E5E1-F119-43D9-974B-7D16487186A2', 'CA4A3F21-C4C2-426D-9F77-266D2E9AD96E', '436C346E-1937-47A0-8F3A-6C5C884205FF', '777D909E-3F8B-4586-8F48-ACD22AAFF672', 'BDDA245F-0461-45E1-AAA3-FA4BD612CEE0', 'FF638DFD-BBB8-4D23-AB37-1859ABB6DCEF', 'A34C358A-A696-4182-BDFD-A28FB92E4D67', '151430C9-C146-4FAB-A283-D1BF5E136BD1', 'B1D64B55-8853-479F-B9FC-0AF95E57C1C8', '6FFF6497-72DE-46FD-AB7D-8132E60F7632', '205FC2DC-850B-44D9-9DD7-03DE80338F6E', 'A29A9568-6C62-47E9-AE58-ADF3CA2A5CDB', '98B3AFF1-4E84-4F1E-9316-021121B15897', 'AACE7389-1CDC-46F7-BFF8-E37965221710', 'E1A2FB11-5D61-4A8E-9A34-565D76688DDA', '1C7C4929-7CED-4B8C-9E3C-90974C4DC927', 'F4692A66-7F0A-4B51-8299-A70B011DD720', 'A98A59DC-D6FE-4469-9957-D232B0DF15F2', 'ED456597-3543-4BFA-A069-74446234B254', '4E4A941B-1074-4322-92E1-06856237CDB0', 'A48F27EA-518A-4320-9BE9-647CCC81CE2C', '98A3AD80-E2B1-4E5B-917F-885A94EA6BC5', 'B726D04A-B64A-4B78-9E94-EF2D38E154DF', '9D73255B-8755-43E4-A04C-5CA71329991C', 'FCD05F6C-4464-4C90-AFB4-14F7CB89D09C', 'E243CA31-2614-4339-89BB-82C003F47AE4', '08E4EEF0-C525-448B-932F-95E86A35680D', 'A7FAD621-5A0E-445F-8A81-20AF45673B56', 'FE682A3D-1A69-450C-A574-21E189ADE4E2', 'A64AB7B0-97E3-4C4E-9D69-9FF05D595B2D', '02A48E3C-1509-4F98-B40A-6F4D56FE128F', '1C064A84-FFC6-45FF-A62E-22D39F27CB70', 'D8E4AD4F-0256-4F47-8ADF-C2CE7ED13468')

-- SessionAssets:
select * from SessionAsset where fk_AssetID = 47898
and fk_SessionID not in ('FBE09C32-4949-43A3-8DBA-197E42A69B5E', '59B6AC4C-E0B1-4EC8-8797-53BECAE67701', 'DD2A18D1-2A4E-4463-A7ED-8C75EFB9AA50', '8CC5091C-74CF-47BF-A8F3-1906FEE01D03', 'FD81BCA6-58BF-4A65-8F0F-510D8609AC62', '832E14FD-9839-40B8-B968-9014C5865B6A', 'CE0F4005-ED3B-4346-ACDC-DEF797B4C4DC', '8E76D616-B571-488B-8732-9D2ACEC6633F', '3B29C209-EABA-4E58-BA8A-011FD11DF9E2', '8AE9B2DC-BBBF-4F7B-93EB-8A91A1597D5C', '4227A174-43BE-41DA-BA41-A44F98BDAA62', '06FE811C-1BD8-44EF-80F0-AE6AEADB5EC0', 'EF96D5E1-FB03-4B9B-8A61-E3B7661695B8', '619E35F7-A41C-44E2-B219-BF7B5B4D7AB0', '392A6F6A-32A4-4110-8E0A-436E81152EA8', '8A0B8F6E-D86C-4237-B3F9-8D714349311E', 'F7A17EB3-62EF-4B6D-B35C-2552CB2FD0BE', '469581EE-D1ED-4CAB-B608-837AA08768A2', 'E4FB6894-5398-4B03-9E16-14ED2DE8CB3E', 'C2E2EAAD-6B87-4C34-BC0A-64AFFA641DB6', '8EACB92E-8E8C-42FD-A90A-DF31437BE334', 'EBB1E5E1-F119-43D9-974B-7D16487186A2', 'CA4A3F21-C4C2-426D-9F77-266D2E9AD96E', '436C346E-1937-47A0-8F3A-6C5C884205FF', '777D909E-3F8B-4586-8F48-ACD22AAFF672', 'BDDA245F-0461-45E1-AAA3-FA4BD612CEE0', 'FF638DFD-BBB8-4D23-AB37-1859ABB6DCEF', 'A34C358A-A696-4182-BDFD-A28FB92E4D67', '151430C9-C146-4FAB-A283-D1BF5E136BD1', 'B1D64B55-8853-479F-B9FC-0AF95E57C1C8', '6FFF6497-72DE-46FD-AB7D-8132E60F7632', '205FC2DC-850B-44D9-9DD7-03DE80338F6E', 'A29A9568-6C62-47E9-AE58-ADF3CA2A5CDB', '98B3AFF1-4E84-4F1E-9316-021121B15897', 'AACE7389-1CDC-46F7-BFF8-E37965221710', 'E1A2FB11-5D61-4A8E-9A34-565D76688DDA', '1C7C4929-7CED-4B8C-9E3C-90974C4DC927', 'F4692A66-7F0A-4B51-8299-A70B011DD720', 'A98A59DC-D6FE-4469-9957-D232B0DF15F2', 'ED456597-3543-4BFA-A069-74446234B254', '4E4A941B-1074-4322-92E1-06856237CDB0', 'A48F27EA-518A-4320-9BE9-647CCC81CE2C', '98A3AD80-E2B1-4E5B-917F-885A94EA6BC5', 'B726D04A-B64A-4B78-9E94-EF2D38E154DF', '9D73255B-8755-43E4-A04C-5CA71329991C', 'FCD05F6C-4464-4C90-AFB4-14F7CB89D09C', 'E243CA31-2614-4339-89BB-82C003F47AE4', '08E4EEF0-C525-448B-932F-95E86A35680D', 'A7FAD621-5A0E-445F-8A81-20AF45673B56', 'FE682A3D-1A69-450C-A574-21E189ADE4E2', 'A64AB7B0-97E3-4C4E-9D69-9FF05D595B2D', '02A48E3C-1509-4F98-B40A-6F4D56FE128F', '1C064A84-FFC6-45FF-A62E-22D39F27CB70', 'D8E4AD4F-0256-4F47-8ADF-C2CE7ED13468')

select * from SessionAsset where fk_SessionID in ('FBE09C32-4949-43A3-8DBA-197E42A69B5E', '59B6AC4C-E0B1-4EC8-8797-53BECAE67701', 'DD2A18D1-2A4E-4463-A7ED-8C75EFB9AA50', '8CC5091C-74CF-47BF-A8F3-1906FEE01D03', 'FD81BCA6-58BF-4A65-8F0F-510D8609AC62', '832E14FD-9839-40B8-B968-9014C5865B6A', 'CE0F4005-ED3B-4346-ACDC-DEF797B4C4DC', '8E76D616-B571-488B-8732-9D2ACEC6633F', '3B29C209-EABA-4E58-BA8A-011FD11DF9E2', '8AE9B2DC-BBBF-4F7B-93EB-8A91A1597D5C', '4227A174-43BE-41DA-BA41-A44F98BDAA62', '06FE811C-1BD8-44EF-80F0-AE6AEADB5EC0', 'EF96D5E1-FB03-4B9B-8A61-E3B7661695B8', '619E35F7-A41C-44E2-B219-BF7B5B4D7AB0', '392A6F6A-32A4-4110-8E0A-436E81152EA8', '8A0B8F6E-D86C-4237-B3F9-8D714349311E', 'F7A17EB3-62EF-4B6D-B35C-2552CB2FD0BE', '469581EE-D1ED-4CAB-B608-837AA08768A2', 'E4FB6894-5398-4B03-9E16-14ED2DE8CB3E', 'C2E2EAAD-6B87-4C34-BC0A-64AFFA641DB6', '8EACB92E-8E8C-42FD-A90A-DF31437BE334', 'EBB1E5E1-F119-43D9-974B-7D16487186A2', 'CA4A3F21-C4C2-426D-9F77-266D2E9AD96E', '436C346E-1937-47A0-8F3A-6C5C884205FF', '777D909E-3F8B-4586-8F48-ACD22AAFF672', 'BDDA245F-0461-45E1-AAA3-FA4BD612CEE0', 'FF638DFD-BBB8-4D23-AB37-1859ABB6DCEF', 'A34C358A-A696-4182-BDFD-A28FB92E4D67', '151430C9-C146-4FAB-A283-D1BF5E136BD1', 'B1D64B55-8853-479F-B9FC-0AF95E57C1C8', '6FFF6497-72DE-46FD-AB7D-8132E60F7632', '205FC2DC-850B-44D9-9DD7-03DE80338F6E', 'A29A9568-6C62-47E9-AE58-ADF3CA2A5CDB', '98B3AFF1-4E84-4F1E-9316-021121B15897', 'AACE7389-1CDC-46F7-BFF8-E37965221710', 'E1A2FB11-5D61-4A8E-9A34-565D76688DDA', '1C7C4929-7CED-4B8C-9E3C-90974C4DC927', 'F4692A66-7F0A-4B51-8299-A70B011DD720', 'A98A59DC-D6FE-4469-9957-D232B0DF15F2', 'ED456597-3543-4BFA-A069-74446234B254', '4E4A941B-1074-4322-92E1-06856237CDB0', 'A48F27EA-518A-4320-9BE9-647CCC81CE2C', '98A3AD80-E2B1-4E5B-917F-885A94EA6BC5', 'B726D04A-B64A-4B78-9E94-EF2D38E154DF', '9D73255B-8755-43E4-A04C-5CA71329991C', 'FCD05F6C-4464-4C90-AFB4-14F7CB89D09C', 'E243CA31-2614-4339-89BB-82C003F47AE4', '08E4EEF0-C525-448B-932F-95E86A35680D', 'A7FAD621-5A0E-445F-8A81-20AF45673B56', 'FE682A3D-1A69-450C-A574-21E189ADE4E2', 'A64AB7B0-97E3-4C4E-9D69-9FF05D595B2D', '02A48E3C-1509-4F98-B40A-6F4D56FE128F', '1C064A84-FFC6-45FF-A62E-22D39F27CB70', 'D8E4AD4F-0256-4F47-8ADF-C2CE7ED13468')
select distinct fk_AssetID from SessionAsset where fk_SessionID in ('FBE09C32-4949-43A3-8DBA-197E42A69B5E', '59B6AC4C-E0B1-4EC8-8797-53BECAE67701', 'DD2A18D1-2A4E-4463-A7ED-8C75EFB9AA50', '8CC5091C-74CF-47BF-A8F3-1906FEE01D03', 'FD81BCA6-58BF-4A65-8F0F-510D8609AC62', '832E14FD-9839-40B8-B968-9014C5865B6A', 'CE0F4005-ED3B-4346-ACDC-DEF797B4C4DC', '8E76D616-B571-488B-8732-9D2ACEC6633F', '3B29C209-EABA-4E58-BA8A-011FD11DF9E2', '8AE9B2DC-BBBF-4F7B-93EB-8A91A1597D5C', '4227A174-43BE-41DA-BA41-A44F98BDAA62', '06FE811C-1BD8-44EF-80F0-AE6AEADB5EC0', 'EF96D5E1-FB03-4B9B-8A61-E3B7661695B8', '619E35F7-A41C-44E2-B219-BF7B5B4D7AB0', '392A6F6A-32A4-4110-8E0A-436E81152EA8', '8A0B8F6E-D86C-4237-B3F9-8D714349311E', 'F7A17EB3-62EF-4B6D-B35C-2552CB2FD0BE', '469581EE-D1ED-4CAB-B608-837AA08768A2', 'E4FB6894-5398-4B03-9E16-14ED2DE8CB3E', 'C2E2EAAD-6B87-4C34-BC0A-64AFFA641DB6', '8EACB92E-8E8C-42FD-A90A-DF31437BE334', 'EBB1E5E1-F119-43D9-974B-7D16487186A2', 'CA4A3F21-C4C2-426D-9F77-266D2E9AD96E', '436C346E-1937-47A0-8F3A-6C5C884205FF', '777D909E-3F8B-4586-8F48-ACD22AAFF672', 'BDDA245F-0461-45E1-AAA3-FA4BD612CEE0', 'FF638DFD-BBB8-4D23-AB37-1859ABB6DCEF', 'A34C358A-A696-4182-BDFD-A28FB92E4D67', '151430C9-C146-4FAB-A283-D1BF5E136BD1', 'B1D64B55-8853-479F-B9FC-0AF95E57C1C8', '6FFF6497-72DE-46FD-AB7D-8132E60F7632', '205FC2DC-850B-44D9-9DD7-03DE80338F6E', 'A29A9568-6C62-47E9-AE58-ADF3CA2A5CDB', '98B3AFF1-4E84-4F1E-9316-021121B15897', 'AACE7389-1CDC-46F7-BFF8-E37965221710', 'E1A2FB11-5D61-4A8E-9A34-565D76688DDA', '1C7C4929-7CED-4B8C-9E3C-90974C4DC927', 'F4692A66-7F0A-4B51-8299-A70B011DD720', 'A98A59DC-D6FE-4469-9957-D232B0DF15F2', 'ED456597-3543-4BFA-A069-74446234B254', '4E4A941B-1074-4322-92E1-06856237CDB0', 'A48F27EA-518A-4320-9BE9-647CCC81CE2C', '98A3AD80-E2B1-4E5B-917F-885A94EA6BC5', 'B726D04A-B64A-4B78-9E94-EF2D38E154DF', '9D73255B-8755-43E4-A04C-5CA71329991C', 'FCD05F6C-4464-4C90-AFB4-14F7CB89D09C', 'E243CA31-2614-4339-89BB-82C003F47AE4', '08E4EEF0-C525-448B-932F-95E86A35680D', 'A7FAD621-5A0E-445F-8A81-20AF45673B56', 'FE682A3D-1A69-450C-A574-21E189ADE4E2', 'A64AB7B0-97E3-4C4E-9D69-9FF05D595B2D', '02A48E3C-1509-4F98-B40A-6F4D56FE128F', '1C064A84-FFC6-45FF-A62E-22D39F27CB70', 'D8E4AD4F-0256-4F47-8ADF-C2CE7ED13468')

select * from [Session]
where id in ('BE37BEE5-3BB1-4148-A6BA-BE5E70A20686', 'C868A982-E3B1-48F7-9E5F-EE19F7B45001', 'C5D1F98D-181F-4F83-A715-E522DCAE23FD', '39D9D0FE-3FEE-46C2-B2E3-E3FB33FB6D32', '5D0B7BF2-AD43-4ED4-878B-A774F232A562', '6973E1B1-3994-438A-9ACC-9DDEFBE1D6B2', 'A635E2DB-DD2B-415C-A4F0-8FF5FEFEE700', '5EE0435E-BDEB-4495-942B-835764AB5EB2', '18258F4B-94AB-4B99-BC0B-73DF3A038DE0', '3F709D11-B48C-4007-B30D-7281EA34D216', 'DA3FCCBF-C46E-4E22-95F5-61457DB9EC3F', '62F0281C-7F60-4EFC-AF81-5D9EA6B5C53C', '30DDB7B1-9981-4583-88BD-48FEB34AF7A0', 'BFA1A046-7FE6-4B77-953C-466C9141E7FD', '84D27781-8414-45D7-8998-2E39E8B417B4', 'FAF9BCBB-0005-486F-9EF4-2D7D887A84BB', '3F4505BE-43A4-4AA2-B79E-131BAFBBE98E', '89856908-B8D1-4FD4-8A15-10683D416B01', 'F7EC14E9-ECDF-4A4B-AF82-0323A5166D42', '42198ADB-4332-4348-8E9B-01D76D71B975', '968B833C-3CDF-43EB-AE8B-F61F3579C49B', '1CABD45E-8DCA-49AF-84CA-F175A208D376', '94AD2248-E583-43ED-A7C8-F0273A078B0F', '6F01E711-D921-4D71-8B7D-00323F95ACC4', '515DE9F5-6167-4496-B460-FD81FC735056', 'A22A2FCE-4EC6-4F02-A72B-12E82B7490A2', 'FE6909D2-7F0A-4766-BF7E-1248D66492DD')

select * from Task
where id in ('79043A77-40AD-4C9F-91CE-19F2D1E23972', 'F3B9AAEC-B481-4927-ADEF-E45D73B218EA', '79043A77-40AD-4C9F-91CE-19F2D1E23972', '79043A77-40AD-4C9F-91CE-19F2D1E23972', 'F3B9AAEC-B481-4927-ADEF-E45D73B218EA', '79043A77-40AD-4C9F-91CE-19F2D1E23972', '18D2B8E1-9A7A-4371-BA55-47C5769CCAE8', '79043A77-40AD-4C9F-91CE-19F2D1E23972', '530793ED-12B7-4357-92ED-72AB3A10CE51', '0946066D-9C54-4EF4-9F78-66A26F07D77B', '8DD1D494-8BCB-4621-AB2E-EBEE8FA157A7', '79043A77-40AD-4C9F-91CE-19F2D1E23972', '6CBCA745-2CB5-4122-BD7D-8692CB1D3F48', 'F3B9AAEC-B481-4927-ADEF-E45D73B218EA', '3E0D872D-5A17-494A-8522-782DB79B0980', '79043A77-40AD-4C9F-91CE-19F2D1E23972', '99C9235E-EA55-4C7F-B7C7-7A31117D85F9', '99C9235E-EA55-4C7F-B7C7-7A31117D85F9', '99C9235E-EA55-4C7F-B7C7-7A31117D85F9', '38AEA384-85E6-4533-9025-4FC2ADD6326D', '45730D10-A7E6-4968-8552-5616CB4DFB4E', 'F6D8EF56-5969-4B3B-A986-87EF66354A23', '0946066D-9C54-4EF4-9F78-66A26F07D77B', '3E0D872D-5A17-494A-8522-782DB79B0980', '8DD1D494-8BCB-4621-AB2E-EBEE8FA157A7', 'F3B9AAEC-B481-4927-ADEF-E45D73B218EA', '45730D10-A7E6-4968-8552-5616CB4DFB4E')

select * from GrownCrop
where id in (1798311, 1798285, 1798314, 1798299, 1798300, 1798307, 1798310, 1798308, 1798284, 1798313, 1798309, 1798289)

select * from Field
where id in (
	select fk_FieldID from GrownCrop
	where id in (1798311, 1798285, 1798314, 1798299, 1798300, 1798307, 1798310, 1798308, 1798284, 1798313, 1798309, 1798289))

select * from Farm
where id = 311155

select * from AssetDevice where fk_AssetID = 47898
select * from Asset where id = 47898
-- SessionHarvests:
select * from SessionHarvest where fk_sessionid in ('FBE09C32-4949-43A3-8DBA-197E42A69B5E', '59B6AC4C-E0B1-4EC8-8797-53BECAE67701', 'DD2A18D1-2A4E-4463-A7ED-8C75EFB9AA50', '8CC5091C-74CF-47BF-A8F3-1906FEE01D03', 'FD81BCA6-58BF-4A65-8F0F-510D8609AC62', '832E14FD-9839-40B8-B968-9014C5865B6A', 'CE0F4005-ED3B-4346-ACDC-DEF797B4C4DC', '8E76D616-B571-488B-8732-9D2ACEC6633F', '3B29C209-EABA-4E58-BA8A-011FD11DF9E2', '8AE9B2DC-BBBF-4F7B-93EB-8A91A1597D5C', '4227A174-43BE-41DA-BA41-A44F98BDAA62', '06FE811C-1BD8-44EF-80F0-AE6AEADB5EC0', 'EF96D5E1-FB03-4B9B-8A61-E3B7661695B8', '619E35F7-A41C-44E2-B219-BF7B5B4D7AB0', '392A6F6A-32A4-4110-8E0A-436E81152EA8', '8A0B8F6E-D86C-4237-B3F9-8D714349311E', 'F7A17EB3-62EF-4B6D-B35C-2552CB2FD0BE', '469581EE-D1ED-4CAB-B608-837AA08768A2', 'E4FB6894-5398-4B03-9E16-14ED2DE8CB3E', 'C2E2EAAD-6B87-4C34-BC0A-64AFFA641DB6', '8EACB92E-8E8C-42FD-A90A-DF31437BE334', 'EBB1E5E1-F119-43D9-974B-7D16487186A2', 'CA4A3F21-C4C2-426D-9F77-266D2E9AD96E', '436C346E-1937-47A0-8F3A-6C5C884205FF', '777D909E-3F8B-4586-8F48-ACD22AAFF672', 'BDDA245F-0461-45E1-AAA3-FA4BD612CEE0', 'FF638DFD-BBB8-4D23-AB37-1859ABB6DCEF', 'A34C358A-A696-4182-BDFD-A28FB92E4D67', '151430C9-C146-4FAB-A283-D1BF5E136BD1', 'B1D64B55-8853-479F-B9FC-0AF95E57C1C8', '6FFF6497-72DE-46FD-AB7D-8132E60F7632', '205FC2DC-850B-44D9-9DD7-03DE80338F6E', 'A29A9568-6C62-47E9-AE58-ADF3CA2A5CDB', '98B3AFF1-4E84-4F1E-9316-021121B15897', 'AACE7389-1CDC-46F7-BFF8-E37965221710', 'E1A2FB11-5D61-4A8E-9A34-565D76688DDA', '1C7C4929-7CED-4B8C-9E3C-90974C4DC927', 'F4692A66-7F0A-4B51-8299-A70B011DD720', 'A98A59DC-D6FE-4469-9957-D232B0DF15F2', 'ED456597-3543-4BFA-A069-74446234B254', '4E4A941B-1074-4322-92E1-06856237CDB0', 'A48F27EA-518A-4320-9BE9-647CCC81CE2C', '98A3AD80-E2B1-4E5B-917F-885A94EA6BC5', 'B726D04A-B64A-4B78-9E94-EF2D38E154DF', '9D73255B-8755-43E4-A04C-5CA71329991C', 'FCD05F6C-4464-4C90-AFB4-14F7CB89D09C', 'E243CA31-2614-4339-89BB-82C003F47AE4', '08E4EEF0-C525-448B-932F-95E86A35680D', 'A7FAD621-5A0E-445F-8A81-20AF45673B56', 'FE682A3D-1A69-450C-A574-21E189ADE4E2', 'A64AB7B0-97E3-4C4E-9D69-9FF05D595B2D', '02A48E3C-1509-4F98-B40A-6F4D56FE128F', '1C064A84-FFC6-45FF-A62E-22D39F27CB70', 'D8E4AD4F-0256-4F47-8ADF-C2CE7ED13468')
--select gc.ads_fldId as ADS_FldId1
--from GrownCrop gc 
--where gc.fk_FieldID in (select f.id from field f where f.fk_FarmID in (@agdenFarmId, @highfieldFarmId)) 
--except (
--	select f.ads_fldId from Field f
--	where f.fk_FarmID in (@agdenFarmId, @highfieldFarmId)
--)
--order by ads_fldId

--select * from [agri-datadb].dbo.AGR_FieldDetails where fld_id in (1319216, 1319217)

-- AssetDeviceID
-- 152582
-- AssetID:
-- 47898

--declare @adsFields TABLE (fld_id int)
--insert into @adsFields select distinct ads_fldId from Field f where f.fk_FarmID in (@agdenFarmId, @highfieldFarmId);

--declare @grownCrops TABLE (gcID bigint)
--insert into @grownCrops select f.fk_GrownCropID from Field f where f.fk_farmID in (@agdenFarmId, @highfieldFarmId);
select count(distinct fld.ID) as field from Field fld where fld.fk_FarmID in (@agdenFarmId, @highfieldFarmId)
select count(distinct gc.ID) as GrownCropCount from Field fld join GrownCrop gc on gc.fk_FieldID = fld.ID where fld.fk_FarmID in (@agdenFarmId, @highfieldFarmId)

--select * from Asset a
--join AssetDevice ad on ad.fk_AssetID = a.ID
--where a.ID = 47898

--select * from AssetSyncSettings
--where fk_AssetId = 47898


--declare @sessionIDs TABLE (sessionID uniqueidentifier)
--insert into @sessionIDs select distinct s.ID 
--from [Session] s
--join Task t on s.fk_TaskID = t.ID
--where t.fk_GrownCropID in (
--	select gc.ID from Field fld join GrownCrop gc on gc.fk_FieldID = fld.ID where fld.fk_FarmID in (@agdenFarmId, @highfieldFarmId)
--	);

--select * from @sessionIDs
--select distinct SessionAsset.fk_AssetID as AssetID from SessionAsset 
--where fk_SessionID in (select sessionID from @sessionIDs)

--select count(distinct fk_SessionID) as ConditionCount from SessionCondition 
--where fk_SessionID in (select sessionID from @sessionIDs)

--select distinct SessionHarvest.fk_MasterCommodityID as MasterCommodityID from SessionHarvest 
--where fk_SessionID in (select sessionID from @sessionIDs)

--select count(distinct fk_ImplementID) as ImplementCount from SessionImplement 
--where fk_SessionID in (select sessionID from @sessionIDs)

--select count(distinct fk_MaterialID) as MaterialCount from SessionMaterial
--where fk_SessionID in (select sessionID from @sessionIDs)

--select count(distinct fk_OperatorID) as OperatorCount from SessionOperator
--where fk_SessionID in (select sessionID from @sessionIDs)

--select count(distinct fk_TankMixID) as TankMixCount from SessionTankMix
--where fk_SessionID in (select sessionID from @sessionIDs)


--select f.ID as FieldID, f.Name as FieldName, f.fk_FarmID as FarmID, frm.Name as FarmName,
--f.fk_OrgID as OrgID, o.Name as OrgName, 
--gc.ID as GrownCropID,
--mc.ID as MasterCropID, mc.Name as MasterCropName,
--cs.ID as CropSeasonID, cs.HarvestYear,
--t.ID as TaskID, t.Name as TaskName,


--from field f
--left outer join Organization o on f.fk_OrgId = o.ID
--left outer join Farm frm on f.fk_FarmID = frm.ID
--left outer join GrownCrop gc on gc.fk_FieldID = f.ID
--left outer join CropSeason cs on gc.fk_CropSeasonID = cs.ID
--left outer join MasterCrop mc on cs.fk_MasterCropID = mc.ID
--left outer join Task t on t.fk_GrownCropID = gc.ID
--where f.fk_FarmID in (@agdenFarmId, @highfieldFarmId);

----where f.ID = @fieldId
----where f.fk_OrgID = @orgId


--s.ID as SessionID, s.fk_FileID as FileID



